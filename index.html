<!doctype html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>H·ªá Th·ªëng D·ª± ƒêo√°n S·ªë (Si√™u Chu·∫©n)</title>
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: #0b1020;
      color: #e8eefc;
      display: grid;
      place-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .card {
      width: min(720px, 92vw);
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 18px;
      padding: 22px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.45);
    }
    h1 { margin: 0 0 8px; font-size: 22px; }
    p { margin: 0 0 16px; opacity: .9; line-height: 1.4; }
    .row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
    }
    input {
      width: 100%;
      padding: 14px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(0,0,0,0.25);
      color: #e8eefc;
      font-size: 16px;
      outline: none;
    }
    button {
      padding: 14px 14px;
      border-radius: 12px;
      border: 0;
      background: #6aa6ff;
      color: #081025;
      font-weight: 700;
      cursor: pointer;
      min-width: 130px;
    }
    button:disabled {
      opacity: .65;
      cursor: not-allowed;
    }
    .status {
      margin-top: 14px;
      padding: 12px;
      border-radius: 12px;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.10);
      min-height: 48px;
      display: grid;
      place-items: center;
      text-align: center;
      font-size: 15px;
    }
    .result {
      font-size: 18px;
      font-weight: 800;
    }
    .tiny {
      margin-top: 10px;
      font-size: 12px;
      opacity: .7;
    }
    .dots::after {
      content: "";
      display: inline-block;
      width: 1.2em;
      text-align: left;
      animation: dots 1.1s infinite;
    }
    @keyframes dots {
      0% { content: ""; }
      25% { content: "."; }
      50% { content: ".."; }
      75% { content: "..."; }
      100% { content: ""; }
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üß† D·ª∞ ƒêO√ÅN S·ªê</h1>
    <p>Nh·∫≠p m·ªôt s·ªë b·∫•t k·ª≥. H·ªá th·ªëng s·∫Ω ‚Äúƒë·ªçc suy nghƒ©‚Äù b·∫°n trong v√†i gi√¢y v√† ƒë∆∞a ra d·ª± ƒëo√°n.</p>

    <div class="row">
      <input id="num" inputmode="numeric" placeholder="Nh·∫≠p s·ªë c·ªßa b·∫°n ·ªü ƒë√¢y..." />
      <button id="btn">D·ª± ƒëo√°n</button>
    </div>

    <div class="status" id="status">
    <b>D·ª± ƒëo√°n</b>
    </div>

  </div>

  <script>
    const input = document.getElementById("num");
    const btn = document.getElementById("btn");
    const status = document.getElementById("status");

    function sleep(ms) {
      return new Promise(res => setTimeout(res, ms));
    }

    btn.addEventListener("click", async () => {
      const value = (input.value ?? "").trim();

      if (!value) {
        status.textContent = "B·∫°n ch∆∞a nh·∫≠p g√¨ c·∫£ üò≠";
        input.focus();
        return;
      }

      // Kho√° n√∫t ƒë·ªÉ t·∫°o c·∫£m gi√°c ‚Äúh·ªá th·ªëng ƒëang ch·∫°y‚Äù
      btn.disabled = true;
      input.disabled = true;

      // Fake loading 1‚Äì5s
      const wait = Math.floor(1000 + Math.random() * 4000);

      status.innerHTML = `ƒêang ƒë·ªçc suy nghƒ© b·∫°n<span class="dots"></span><br><small>(∆∞·ªõc t√≠nh ${Math.round(wait/100)/10}s)</small>`;

      await sleep(wait);

      // ‚ÄúD·ª± ƒëo√°n‚Äù: th·∫≠t ra l√† in l·∫°i ƒë√∫ng th·ª© ng∆∞·ªùi d√πng nh·∫≠p
      status.innerHTML = `D·ª± ƒëo√°n c·ªßa h·ªá th·ªëng l√†: <span class="result">${escapeHtml(value)}</span>`;

      btn.disabled = false;
      input.disabled = false;
      input.focus();
      input.select();
    });

    // Tr√°nh ng∆∞·ªùi d√πng nh·∫≠p html ph√° giao di·ªán
    function escapeHtml(str) {
      return str
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    // Enter ƒë·ªÉ ch·∫°y
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") btn.click();
    });
    
  </script>
<script>
  const KEY = "last_logged_day";
  const today = new Date().toISOString().slice(0,10); // YYYY-MM-DD

  if (localStorage.getItem(KEY) !== today) {
    localStorage.setItem(KEY, today);
    fetch("/api/visit", { method: "POST" }).catch(()=>{});
  }
</script>


</body>
</html>
